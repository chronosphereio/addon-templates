{"name":"MS-Windows-Eventlog-v3","config":{"Name":"lua","match":"*","code":"cb_filter=require('calyptia.pr')([====================[[{\"type\":\"multiline_join\",\"opts\":{\"src\":\"log\",\"regex\":\"\\\\d{2}\\\\/\\\\d{2}\\\\/\\\\d{4}\\\\s\",\"regexEngine\":\"pcre2\",\"lineLimit\":1000},\"comment\":\"restitch per-line broken event\",\"id\":\"95cc2755-0aa0-48bb-8e68-ae8412a454f6\",\"active\":true},{\"type\":\"rename\",\"opts\":{\"src\":\"log\",\"dst\":\"Message\",\"matchCase\":true,\"regexEngine\":\"pcre2\",\"regexMode\":false},\"comment\":\"convert log to Message\",\"id\":\"5e04243f-5e0f-4447-80b3-e2310dce1732\",\"active\":true},{\"type\":\"custom_script\",\"opts\":{\"script\":\"return function(tag, ts, record)\\n    -- Define a table with the critical EventIDs\\n    local critical_event_ids = {4608, 4609, 4610, 4611, 4612, 4614, 4615, 4616, 4622, 4624, 4625, 4634, 4646, 4647, 4648, 4650, 4651, 4652, 4653, 4654, 4655, 4656, 4657, 4658, 4659, 4660, 4661, 4662, 4663, 4664, 4665, 4666, 4667, 4668, 4670, 4671, 4672, 4673, 4674, 4688, 4689, 4690, 4691, 4694, 4695, 4696, 4697, 4698, 4699, 4700, 4701, 4702, 4704, 4705, 4707, 4709, 4710, 4711, 4712, 4717, 4718, 4720, 4722, 4723, 4725, 4726, 4728, 4729, 4730, 4731, 4732, 4733, 4734, 4738, 4740, 4741, 4742, 4743, 4744, 4745, 4746, 4747, 4748, 4749, 4750, 4751, 4752, 4753, 4756, 4757, 4758, 4759, 4760, 4761, 4762, 4767, 4768, 4769, 4770, 4771, 4772, 4774, 4775, 4776, 4777, 4778, 4779, 4781, 4782, 4783, 4784, 4785, 4786, 4787, 4788, 4789, 4790, 4793, 4800, 4801, 4802, 4803, 4864, 4869, 4871, 4872, 4873, 4874, 4875, 4876, 4877, 4878, 4879, 4880, 4881, 4883, 4884, 4886, 4887, 4888, 4889, 4891, 4893, 4894, 4895, 4898, 4902, 4904, 4905, 4909, 4910, 4928, 4929, 4930, 4931, 4932, 4933, 4934, 4935, 4936, 4937, 4944, 4945, 4946, 4947, 4948, 4949, 4950, 4951, 4952, 4953, 4954, 4956, 4957, 4958, 4979, 4980, 4981, 4982, 4985, 5024, 5025, 5031, 5032, 5033, 5034, 5039, 5040, 5041, 5042, 5043, 5044, 5045, 5046, 5047, 5048, 5050, 5051, 5056, 5057, 5058, 5059, 5060, 5061, 5062, 5063, 5064, 5065, 5066, 5067, 5068, 5069, 5070, 5125, 5126, 5127, 5136, 5137, 5138, 5139, 5140, 5141, 5152, 5153, 5154, 5155, 5156, 5157, 5158, 5159, 5378, 5440, 5441, 5442, 5443, 5444, 5446, 5447, 5448, 5449, 5450, 5451, 5452, 5456, 5457, 5458, 5459, 5460, 5461, 5462, 5463, 5464, 5465, 5466, 5467, 5468, 5471, 5472, 5473, 5474, 5477, 5479, 5632, 5633, 5712, 5888, 5889, 5890, 6008, 6144, 6272, 24577, 24578, 24579, 24580, 24581, 24582, 24583, 24584, 24588, 24595, 24621, 5049, 5478, 561, 563, 625, 613, 614, 615, 616}\\n    -- Check if the EventID is in the critical_event_ids table\\n    if critical_event_ids[record['EventID']] ~= nil then\\n        -- Set the value of criticality to \\\"Low\\\"\\n        record['criticality'] = \\\"Low\\\"\\n    else\\n        -- Set the value of criticality to \\\"Medium/High\\\"\\n        record['criticality'] = \\\"Medium/High\\\"\\n    end\\n    return 1, ts, record\\nend\"},\"comment\":\"create a new field called \\\"criticality\\\", check if the EventID is one of these values:\\n\\n4608, 4609, 4610, 4611, 4612, 4614,\\n\\n\\nif so, set the value of criticality to \\\"Low\\\", otherwise set the value to \\\"Medium/High\\\"\",\"id\":\"a575f2e3-5347-4c1e-b13e-d0a11543251d\",\"active\":false},{\"type\":\"block_records\",\"opts\":{\"key\":\"criticality\",\"regex\":\"Low\",\"matchCase\":false,\"regexEngine\":\"pcre2\"},\"comment\":\"block events that microsoft says are low criticality\",\"id\":\"ea152e83-c712-4094-bd00-2cf4d184eac7\",\"active\":false},{\"type\":\"custom_script\",\"opts\":{\"script\":\"return function(tag, ts, record)\\n    -- check if the record has a Message field\\n    if record['Message'] ~= nil then\\n        -- Prepend the string \\\"EventDetail\\\":\\\" to the beginning of the Message field\\n        record['Message'] = '{\\\"EventDetail\\\":\\\"' .. record['Message']\\n\\n        -- Replace specific patterns involving carriage return and newlines\\n        record['Message'] = record['Message']:gsub('\\\\r\\\\n\\\\r\\\\n([%w%s]+):\\\\r\\\\n\\\\t', '\\\"},\\\"%1\\\":{\\\"')  -- Replace \\\\r\\\\n and a tab sequence\\n        record['Message'] = record['Message']:gsub('\\\\r\\\\n\\\\r\\\\n([%w%s]+):\\\\t\\\\t\\\\t', '\\\"},\\\"%1\\\"::\\\"')  -- Replace \\\\r\\\\n and a tab sequence\\n        record['Message'] = record['Message']:gsub('\\\\r\\\\n\\\\r\\\\n([%w%s]+):\\\\t', '\\\"},\\\"%1\\\":\\\"')  -- Replace \\\\r\\\\n and a tab sequence\\n        record['Message'] = record['Message']:gsub('\\\\r\\\\n\\\\t', '\\\",\\\"')   -- Replace \\\\r\\\\n and a tab with `\\\",\\\"`\\n        record['Message'] = record['Message']:gsub('%.\\\\r\\\\n\\\\r\\\\n', '\\\",\\\"')  -- Replace double \\\\r\\\\n with `\\\"}` to close a JSON structure\\n        record['Message'] = record['Message']:gsub('\\\\r\\\\n\\\\r\\\\n', '\\\"},\\\"FieldDescriptions\\\":[\\\"')  -- Replace double \\\\r\\\\n with `\\\"}` to close a JSON structure\\n        record['Message'] = record['Message']:gsub('\\\\r\\\\n([%w%s]+):\\\\t', '\\\",\\\"%1\\\":\\\"')  -- Replace double \\\\r\\\\n with `\\\"}` to close a JSON structure\\n        record['Message'] = record['Message']:gsub('\\\\n([%w%s]+)=([^\\\\n\\\\r]+)', '\\\",\\\"%1\\\":\\\"%2')\\n\\n        -- Replace tab patterns\\n        record['Message'] = record['Message']:gsub(':\\\\t\\\\t\\\\t', '\\\":\\\"')  -- Replace triple tab sequence\\n        record['Message'] = record['Message']:gsub(':\\\\t\\\\t', '\\\":\\\"')    -- Replace double tab sequence\\n        record['Message'] = record['Message']:gsub(':\\\\t', '\\\":\\\"')      -- Replace single tab sequence\\n\\n        -- Replace spaces in key names only (i.e., before `\\\":\\\"`)\\n        record['Message'] = record['Message']:gsub('\\\\\\\"([%w%s]+)\\\\\\\":', function(key)\\n            -- Replace spaces in the key with underscores\\n            return '\\\"' .. key:gsub('%s', '_') .. '\\\":'\\n        end)\\n\\n        -- Fix missing quotes, commas, and other broken patterns\\n        record['Message'] = record['Message']:gsub('}([%w]+):', '},\\\"%1\\\":')  -- Add quotes and commas for broken patterns\\n        record['Message'] = record['Message']:gsub('(,[%w]+):', '\\\"%1\\\":')    -- Ensure all keys are quoted\\n        record['Message'] = record['Message']:gsub('::\\\"([%w]+)\\\"},', ':\\\"%1\\\",')    -- fix one sided arrays\\n        record['Message'] = record['Message']:gsub('\\\"\\\"C\\\"', '\\\"C')    -- fix malformed file paths\\n        record['Message'] = record['Message']:gsub('\\\\\\\\', '/')    -- change all double backslashes to forward slashes\\n\\n        -- Ensure the message ends correctly if it's being treated like JSON\\n        if record['Message']:match('FieldDescriptions\\\"') then\\n            record['Message'] = record['Message'] .. '\\\"]' \\n        end\\n\\n        if not record['Message']:match('FieldDescriptions\\\"') then\\n            record['Message'] = record['Message'] .. '\\\"' \\n        end\\n\\n        -- Wrap everything inside the outer JSON object {\\\"Event\\\": ...}\\n        record['Message'] = '{\\\"Event\\\":' .. record['Message'] .. '}'\\n    end\\n    return 1, ts, record\\nend\\n\"},\"comment\":\"convert message field to json string\",\"id\":\"5dacf81b-79dd-405f-a608-862676c5564a\",\"active\":true},{\"type\":\"json_decode\",\"opts\":{\"src\":\"Message\",\"dst\":\"decoded_json\"},\"comment\":\"\",\"id\":\"032f26a5-2555-4337-8f4d-3f389f419125\",\"active\":true},{\"type\":\"custom_script\",\"opts\":{\"script\":\"-- Define a function that checks if a value is empty, \\\"\\\", n/a, or null\\nlocal function is_empty(v)\\n    return v == nil or v == \\\"\\\" or v == \\\"n/a\\\" or v == \\\"null\\\" or v == \\\"-\\\"\\n  end\\n  \\n  -- Define a function that recursively removes empty keys from a subrecord\\n  local function remove_empty_keys(subrecord)\\n    for k, v in pairs(subrecord) do\\n      -- Check if the value is empty using the 'is_empty' function\\n      if is_empty(v) then\\n        -- If the value is empty, delete the key\\n        subrecord[k] = nil\\n      elseif type(v) == 'table' then\\n        -- If the value is a table, recursively call the 'remove_empty_keys' function\\n        remove_empty_keys(v)\\n      end\\n    end\\n  end\\n  \\n  return function(tag, ts, record)\\n    -- Check if the record has a 'scopeLog' field\\n    if record['decoded_json'] ~= nil then\\n      -- Call the 'remove_empty_keys' function on the 'scopeLog' subrecord\\n      remove_empty_keys(record['decoded_json'])\\n    end\\n    return 1, ts, record\\n  end\"},\"comment\":\"remove keys with empty values\",\"id\":\"3916b49a-c75b-411f-86c2-802160329a8d\",\"active\":true},{\"type\":\"flatten\",\"opts\":{\"key\":\"decoded_json\",\"regex\":\"^.+$\",\"keyReplacement\":\"%1\",\"keepOrig\":false},\"comment\":\"\",\"id\":\"ef9baac7-befc-4b9e-b496-98023d4c3218\",\"active\":true},{\"type\":\"block_keys\",\"opts\":{\"regex\":\"Message|FieldDescriptions|StringInserts\",\"matchCase\":false,\"regexEngine\":\"pcre2\",\"nestedPath\":\"\"},\"comment\":\"remove Message, StringInserts, FieldDescriptions\",\"id\":\"66921445-6daf-4f5c-9287-7d7bb7ce35aa\",\"active\":true},{\"type\":\"custom_script\",\"opts\":{\"script\":\"return function(tag, ts, record)\\n    for k, v in pairs(record) do\\n        -- check if the value is empty\\n        if v == '' then\\n            -- delete the key\\n            record[k] = nil\\n        end\\n    end\\n    return 1, ts, record\\nend\"},\"comment\":\"remove empty keys\",\"id\":\"7860cd6b-bfce-47ba-ba2a-c25fff237e77\",\"active\":true}]]====================])","call":"cb_filter"},"input":"{\"date\":1737141566.471443,\"log\":\"01/17/2025 02:19:25 PM\"},{\"date\":1737141566.471447,\"log\":\"LogName=Security\"},{\"date\":1737141566.471447,\"log\":\"EventCode=4688\"},{\"date\":1737141566.471448,\"log\":\"EventType=0\"},{\"date\":1737141566.471448,\"log\":\"ComputerName=CND2321WH5.tec.net\"},{\"date\":1737141566.471449,\"log\":\"SourceName=Microsoft Windows security auditing.\"},{\"date\":1737141566.471449,\"log\":\"Type=Information\"},{\"date\":1737141566.47145,\"log\":\"RecordNumber=17110257\"},{\"date\":1737141566.47145,\"log\":\"Keywords=Audit Success\"},{\"date\":1737141566.47145,\"log\":\"TaskCategory=Process Creation\"},{\"date\":1737141566.471451,\"log\":\"OpCode=Info\"},{\"date\":1737141566.471451,\"log\":\"Message=A new process has been created.\\r\"},{\"date\":1737141566.471452,\"log\":\"\\r\"},{\"date\":1737141566.471452,\"log\":\"Creator Subject:\\r\"},{\"date\":1737141566.471452,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\SYSTEM\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Name:\\t\\tCND2321WH5$\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Domain:\\t\\tTECO\\r\"},{\"date\":1737141566.471454,\"log\":\"\\tLogon ID:\\t\\t0x3E7\\r\"},{\"date\":1737141566.471454,\"log\":\"\\r\"},{\"date\":1737141566.471454,\"log\":\"Target Subject:\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\LOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Name:\\t\\tLOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Domain:\\t\\tNT AUTHORITY\\r\"},{\"date\":1737141566.471456,\"log\":\"\\tLogon ID:\\t\\t0x3E5\\r\"},{\"date\":1737141566.471456,\"log\":\"\\r\"},{\"date\":1737141566.471456,\"log\":\"Process Information:\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process ID:\\t\\t0x37b0\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process Name:\\tC:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tToken Elevation Type:\\t%%1936\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tMandatory Label:\\t\\tMandatory Label\\\\System Mandatory Level\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process ID:\\t0x768\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process Name:\\tC:\\\\Windows\\\\System32\\\\svchost.exe\\r\"},{\"date\":1737141566.471459,\"log\":\"\\tProcess Command Line:\\tC:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe -Embedding\\r\"},{\"date\":1737141566.471459,\"log\":\"\\r\"},{\"date\":1737141566.47146,\"log\":\"Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\\r\"},{\"date\":1737141566.47146,\"log\":\"\\r\"},{\"date\":1737141566.471461,\"log\":\"Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\\r\"},{\"date\":1737141566.471461,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\\r\"},{\"date\":1737141566.471462,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.\"}\n{\"date\":1737141566.471443,\"log\":\"01/17/2025 02:19:25 PM\"},{\"date\":1737141566.471447,\"log\":\"LogName=Security\"},{\"date\":1737141566.471447,\"log\":\"EventCode=4688\"},{\"date\":1737141566.471448,\"log\":\"EventType=0\"},{\"date\":1737141566.471448,\"log\":\"ComputerName=CND2321WH5.tec.net\"},{\"date\":1737141566.471449,\"log\":\"SourceName=Microsoft Windows security auditing.\"},{\"date\":1737141566.471449,\"log\":\"Type=Information\"},{\"date\":1737141566.47145,\"log\":\"RecordNumber=17110257\"},{\"date\":1737141566.47145,\"log\":\"Keywords=Audit Success\"},{\"date\":1737141566.47145,\"log\":\"TaskCategory=Process Creation\"},{\"date\":1737141566.471451,\"log\":\"OpCode=Info\"},{\"date\":1737141566.471451,\"log\":\"Message=A new process has been created.\\r\"},{\"date\":1737141566.471452,\"log\":\"\\r\"},{\"date\":1737141566.471452,\"log\":\"Creator Subject:\\r\"},{\"date\":1737141566.471452,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\SYSTEM\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Name:\\t\\tCND2321WH5$\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Domain:\\t\\tTECO\\r\"},{\"date\":1737141566.471454,\"log\":\"\\tLogon ID:\\t\\t0x3E7\\r\"},{\"date\":1737141566.471454,\"log\":\"\\r\"},{\"date\":1737141566.471454,\"log\":\"Target Subject:\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\LOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Name:\\t\\tLOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Domain:\\t\\tNT AUTHORITY\\r\"},{\"date\":1737141566.471456,\"log\":\"\\tLogon ID:\\t\\t0x3E5\\r\"},{\"date\":1737141566.471456,\"log\":\"\\r\"},{\"date\":1737141566.471456,\"log\":\"Process Information:\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process ID:\\t\\t0x37b0\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process Name:\\tC:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tToken Elevation Type:\\t%%1936\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tMandatory Label:\\t\\tMandatory Label\\\\System Mandatory Level\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process ID:\\t0x768\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process Name:\\tC:\\\\Windows\\\\System32\\\\svchost.exe\\r\"},{\"date\":1737141566.471459,\"log\":\"\\tProcess Command Line:\\tC:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe -Embedding\\r\"},{\"date\":1737141566.471459,\"log\":\"\\r\"},{\"date\":1737141566.47146,\"log\":\"Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\\r\"},{\"date\":1737141566.47146,\"log\":\"\\r\"},{\"date\":1737141566.471461,\"log\":\"Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\\r\"},{\"date\":1737141566.471461,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\\r\"},{\"date\":1737141566.471462,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.\"}{\"date\":1737141566.471443,\"log\":\"01/17/2025 02:19:25 PM\"},{\"date\":1737141566.471447,\"log\":\"LogName=Security\"},{\"date\":1737141566.471447,\"log\":\"EventCode=4688\"},{\"date\":1737141566.471448,\"log\":\"EventType=0\"},{\"date\":1737141566.471448,\"log\":\"ComputerName=CND2321WH5.tec.net\"},{\"date\":1737141566.471449,\"log\":\"SourceName=Microsoft Windows security auditing.\"},{\"date\":1737141566.471449,\"log\":\"Type=Information\"},{\"date\":1737141566.47145,\"log\":\"RecordNumber=17110257\"},{\"date\":1737141566.47145,\"log\":\"Keywords=Audit Success\"},{\"date\":1737141566.47145,\"log\":\"TaskCategory=Process Creation\"},{\"date\":1737141566.471451,\"log\":\"OpCode=Info\"},{\"date\":1737141566.471451,\"log\":\"Message=A new process has been created.\\r\"},{\"date\":1737141566.471452,\"log\":\"\\r\"},{\"date\":1737141566.471452,\"log\":\"Creator Subject:\\r\"},{\"date\":1737141566.471452,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\SYSTEM\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Name:\\t\\tCND2321WH5$\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Domain:\\t\\tTECO\\r\"},{\"date\":1737141566.471454,\"log\":\"\\tLogon ID:\\t\\t0x3E7\\r\"},{\"date\":1737141566.471454,\"log\":\"\\r\"},{\"date\":1737141566.471454,\"log\":\"Target Subject:\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\LOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Name:\\t\\tLOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Domain:\\t\\tNT AUTHORITY\\r\"},{\"date\":1737141566.471456,\"log\":\"\\tLogon ID:\\t\\t0x3E5\\r\"},{\"date\":1737141566.471456,\"log\":\"\\r\"},{\"date\":1737141566.471456,\"log\":\"Process Information:\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process ID:\\t\\t0x37b0\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process Name:\\tC:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tToken Elevation Type:\\t%%1936\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tMandatory Label:\\t\\tMandatory Label\\\\System Mandatory Level\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process ID:\\t0x768\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process Name:\\tC:\\\\Windows\\\\System32\\\\svchost.exe\\r\"},{\"date\":1737141566.471459,\"log\":\"\\tProcess Command Line:\\tC:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe -Embedding\\r\"},{\"date\":1737141566.471459,\"log\":\"\\r\"},{\"date\":1737141566.47146,\"log\":\"Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\\r\"},{\"date\":1737141566.47146,\"log\":\"\\r\"},{\"date\":1737141566.471461,\"log\":\"Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\\r\"},{\"date\":1737141566.471461,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\\r\"},{\"date\":1737141566.471462,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.\"}{\"date\":1737141566.471443,\"log\":\"01/17/2025 02:19:25 PM\"},{\"date\":1737141566.471447,\"log\":\"LogName=Security\"},{\"date\":1737141566.471447,\"log\":\"EventCode=4688\"},{\"date\":1737141566.471448,\"log\":\"EventType=0\"},{\"date\":1737141566.471448,\"log\":\"ComputerName=CND2321WH5.tec.net\"},{\"date\":1737141566.471449,\"log\":\"SourceName=Microsoft Windows security auditing.\"},{\"date\":1737141566.471449,\"log\":\"Type=Information\"},{\"date\":1737141566.47145,\"log\":\"RecordNumber=17110257\"},{\"date\":1737141566.47145,\"log\":\"Keywords=Audit Success\"},{\"date\":1737141566.47145,\"log\":\"TaskCategory=Process Creation\"},{\"date\":1737141566.471451,\"log\":\"OpCode=Info\"},{\"date\":1737141566.471451,\"log\":\"Message=A new process has been created.\\r\"},{\"date\":1737141566.471452,\"log\":\"\\r\"},{\"date\":1737141566.471452,\"log\":\"Creator Subject:\\r\"},{\"date\":1737141566.471452,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\SYSTEM\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Name:\\t\\tCND2321WH5$\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Domain:\\t\\tTECO\\r\"},{\"date\":1737141566.471454,\"log\":\"\\tLogon ID:\\t\\t0x3E7\\r\"},{\"date\":1737141566.471454,\"log\":\"\\r\"},{\"date\":1737141566.471454,\"log\":\"Target Subject:\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\LOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Name:\\t\\tLOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Domain:\\t\\tNT AUTHORITY\\r\"},{\"date\":1737141566.471456,\"log\":\"\\tLogon ID:\\t\\t0x3E5\\r\"},{\"date\":1737141566.471456,\"log\":\"\\r\"},{\"date\":1737141566.471456,\"log\":\"Process Information:\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process ID:\\t\\t0x37b0\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process Name:\\tC:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tToken Elevation Type:\\t%%1936\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tMandatory Label:\\t\\tMandatory Label\\\\System Mandatory Level\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process ID:\\t0x768\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process Name:\\tC:\\\\Windows\\\\System32\\\\svchost.exe\\r\"},{\"date\":1737141566.471459,\"log\":\"\\tProcess Command Line:\\tC:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe -Embedding\\r\"},{\"date\":1737141566.471459,\"log\":\"\\r\"},{\"date\":1737141566.47146,\"log\":\"Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\\r\"},{\"date\":1737141566.47146,\"log\":\"\\r\"},{\"date\":1737141566.471461,\"log\":\"Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\\r\"},{\"date\":1737141566.471461,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\\r\"},{\"date\":1737141566.471462,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.\"}{\"date\":1737141566.471443,\"log\":\"01/17/2025 02:19:25 PM\"},{\"date\":1737141566.471447,\"log\":\"LogName=Security\"},{\"date\":1737141566.471447,\"log\":\"EventCode=4688\"},{\"date\":1737141566.471448,\"log\":\"EventType=0\"},{\"date\":1737141566.471448,\"log\":\"ComputerName=CND2321WH5.tec.net\"},{\"date\":1737141566.471449,\"log\":\"SourceName=Microsoft Windows security auditing.\"},{\"date\":1737141566.471449,\"log\":\"Type=Information\"},{\"date\":1737141566.47145,\"log\":\"RecordNumber=17110257\"},{\"date\":1737141566.47145,\"log\":\"Keywords=Audit Success\"},{\"date\":1737141566.47145,\"log\":\"TaskCategory=Process Creation\"},{\"date\":1737141566.471451,\"log\":\"OpCode=Info\"},{\"date\":1737141566.471451,\"log\":\"Message=A new process has been created.\\r\"},{\"date\":1737141566.471452,\"log\":\"\\r\"},{\"date\":1737141566.471452,\"log\":\"Creator Subject:\\r\"},{\"date\":1737141566.471452,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\SYSTEM\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Name:\\t\\tCND2321WH5$\\r\"},{\"date\":1737141566.471453,\"log\":\"\\tAccount Domain:\\t\\tTECO\\r\"},{\"date\":1737141566.471454,\"log\":\"\\tLogon ID:\\t\\t0x3E7\\r\"},{\"date\":1737141566.471454,\"log\":\"\\r\"},{\"date\":1737141566.471454,\"log\":\"Target Subject:\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tSecurity ID:\\t\\tNT AUTHORITY\\\\LOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Name:\\t\\tLOCAL SERVICE\\r\"},{\"date\":1737141566.471455,\"log\":\"\\tAccount Domain:\\t\\tNT AUTHORITY\\r\"},{\"date\":1737141566.471456,\"log\":\"\\tLogon ID:\\t\\t0x3E5\\r\"},{\"date\":1737141566.471456,\"log\":\"\\r\"},{\"date\":1737141566.471456,\"log\":\"Process Information:\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process ID:\\t\\t0x37b0\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tNew Process Name:\\tC:\\\\Windows\\\\System32\\\\wbem\\\\WmiPrvSE.exe\\r\"},{\"date\":1737141566.471457,\"log\":\"\\tToken Elevation Type:\\t%%1936\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tMandatory Label:\\t\\tMandatory Label\\\\System Mandatory Level\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process ID:\\t0x768\\r\"},{\"date\":1737141566.471458,\"log\":\"\\tCreator Process Name:\\tC:\\\\Windows\\\\System32\\\\svchost.exe\\r\"},{\"date\":1737141566.471459,\"log\":\"\\tProcess Command Line:\\tC:\\\\WINDOWS\\\\system32\\\\wbem\\\\wmiprvse.exe -Embedding\\r\"},{\"date\":1737141566.471459,\"log\":\"\\r\"},{\"date\":1737141566.47146,\"log\":\"Token Elevation Type indicates the type of token that was assigned to the new process in accordance with User Account Control policy.\\r\"},{\"date\":1737141566.47146,\"log\":\"\\r\"},{\"date\":1737141566.471461,\"log\":\"Type 1 is a full token with no privileges removed or groups disabled.  A full token is only used if User Account Control is disabled or if the user is the built-in Administrator account or a service account.\\r\"},{\"date\":1737141566.471461,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 2 is an elevated token with no privileges removed or groups disabled.  An elevated token is used when User Account Control is enabled and the user chooses to start the program using Run as administrator.  An elevated token is also used when an application is configured to always require administrative privilege or to always require maximum privilege, and the user is a member of the Administrators group.\\r\"},{\"date\":1737141566.471462,\"log\":\"\\r\"},{\"date\":1737141566.471462,\"log\":\"Type 3 is a limited token with administrative privileges removed and administrative groups disabled.  The limited token is used when User Account Control is enabled, the application does not require administrative privilege, and the user does not choose to start the program using Run as administrator.\"}","isRawInput":false,"pipelineVersion":"25.1.1"}